{% extends 'index.html' %}
{% load static %}
{% block content %}
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background: #f8f9fa;
  }
  .success-section {
    padding: 2em 0;
    max-width: 1000px;
    margin: 0 auto;
  }
  .confirmation-card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    margin-bottom: 1.5rem;
    padding: 1.5rem;
  }
  .membership-card {
    background: #f0f8ff;
    border-left: 4px solid #007bff;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    margin-bottom: 1.5rem;
    padding: 1.5rem;
  }
  .invoice-card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    margin-bottom: 1.5rem;
    padding: 1.5rem;
  }
  .card-header {
    background: transparent;
    border: none;
    padding: 0.5rem 0;
    margin-bottom: 1rem;
    font-weight: 600;
    font-size: 1.1rem;
    color: #333;
  }
  .text-green {
    color: #28a745;
  }
  .text-blue {
    color: #007bff;
  }
  .label {
    color: #666;
    font-size: 0.9rem;
    margin: 0.5rem 0 0.25rem 0;
  }
  .value {
    font-weight: 500;
    margin-bottom: 0.75rem;
  }
  .action-btns {
    display: flex;
    justify-content: space-between;
    margin-top: 1.5rem;
  }
  .btn-primary {
    background-color: #007bff;
    border-color: #007bff;
    padding: 0.5rem 1rem;
    font-weight: 500;
  }
  .btn-primary:hover {
    background-color: #0069d9;
    border-color: #0062cc;
  }
  h1.page-title {
    font-weight: 600;
    color: #333;
    margin-bottom: 1.5rem;
  }
  .hero-bg {
    background-image: url("{% static 'images/bg_1.jpg' %}");
    background-size: cover;
    background-position: center;
    padding: 4rem 0;
    position: relative;
  }
  .hero-bg .overlay {
    background: rgba(0, 0, 0, 0.4);
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 1;
  }
  .hero-content {
    position: relative;
    z-index: 2;
  }
  .section-title {
    font-weight: 600;
    color: #fff;
    margin-bottom: 0;
  }
  .breadcrumb {
    background: transparent;
    padding: 0;
    margin-bottom: 0.5rem;
  }
  .breadcrumb a {
    color: #ddd;
  }
  .breadcrumb .active {
    color: #fff;
  }
</style>

<!-- Hero Header -->
<section class="hero-bg">
  <div class="overlay"></div>
  <div class="container hero-content">
    <div class="row">
      <div class="col-12">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
            <li class="breadcrumb-item"><a href="{% url 'membership' %}">Membership</a></li>
            <li class="breadcrumb-item active">Subscription Success</li>
          </ol>
        </nav>
        <h1 class="section-title">Subscription Activated</h1>
      </div>
    </div>
  </div>
</section>

<!-- Main Content -->
<section class="success-section">
  <div class="container">
    <!-- Confirmation -->
    <div class="confirmation-card">
      <div class="card-header">Confirmation</div>
      <h3 class="text-green mb-3">ðŸŽ‰ Membership Activated Successfully!</h3>
      <p>
        Thank you for joining <strong>{{ site_name }}</strong>!
        Your subscription details will be sent to <strong>{{ subscription_order.customer.email }}</strong>.
        If you do not receive it within a few minutes, please check your spam or junk folder.
      </p>
      <div class="label">Order Number</div>
      <div class="value">{{ subscription_order.order_number }}</div>
      <div class="label">Date</div>
      <div class="value">{{ subscription_order.created_at }}</div>
    </div>

    <!-- Membership Details -->
    <div class="membership-card">
      <div class="card-header">Your Membership</div>
      <div class="label">Member</div>
      <div class="value">{{ subscription_order.customer.get_full_name }}</div>
      <div class="label">Package</div>
      <div class="value">{{ subscription_order.package.name }} ({{ subscription_order.package.type|capfirst }})</div>
      <div class="label">Status</div>
      <div class="value text-success">{{ subscription_order.get_status_display }}</div>
      <div class="label">Start Date</div>
      <div class="value">{{ subscription_order.start_date }}</div>
      <div class="label">End Date</div>
      <div class="value">{{ subscription_order.end_date }}</div>
      <div class="label">Invoice Number</div>
      <div class="value">{{ subscription_order.invoice_number|default:"Pending" }}</div>
    </div>
  </div>
</section>

<!-- Invoice Summary -->
<div class="container">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="invoice-card">
        <div class="card-header">Payment</div>
        <div class="label">Total Paid</div>
        <div class="value">â‚¹{{ subscription_order.total }}</div>
        <div class="label">Payment Method</div>
        <div class="value">Cashfree</div>
        <div class="label">Payment Status</div>
        <div class="value text-success">{{ subscription_order.get_payment_status_display }}</div>
        <div class="action-btns">
          <a href="{% url 'home' %}" class="btn btn-primary">Back to Home</a>
          <a href="#" class="btn btn-primary">Download Invoice</a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Prevent back navigation -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    history.replaceState(null, null, window.location.pathname);
    window.onpopstate = function (event) {
      window.location.href = "{% url 'home' %}";
    };
  });
</script>
{% endblock %}
